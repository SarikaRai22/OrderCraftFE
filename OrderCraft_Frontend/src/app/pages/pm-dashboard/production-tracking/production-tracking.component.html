<div class="tracking-container">
  <h2>Track Production</h2>

  <div class="form-group">
    <label for="scheduleSelect">Select Schedule:</label>
    <select id="scheduleSelect" [(ngModel)]="selectedScheduleId" (change)="onScheduleSelect()">
      <option value="" disabled selected>Select a schedule</option>
      <option *ngFor="let s of schedules" [value]="s.scheduleId">
        #{{ s.scheduleId }} - {{ s.productName }}
      </option>
    </select>
  </div>

  <div class="text-end mt-3">
    <button class="btn btn-primary" (click)="refreshSchedules()">
      <i class="bi bi-arrow-repeat"></i> Refresh
    </button>
  </div>

  <div *ngIf="progress" class="timeline-wrapper mt-5">
    <div class="timeline d-flex justify-content-between position-relative">
      <div class="step text-center" *ngFor="let stage of stages; let i = index">
        <div class="circle-wrapper position-relative d-flex flex-column align-items-center">
          <div class="circle d-flex align-items-center justify-content-center mb-2"
               [ngClass]="{ 'active': isStageActive(stage) }">
            <i class="bi bi-check-lg"></i>
          </div>

          <div class="line position-absolute top-50 start-100 translate-middle-y"
               *ngIf="i < stages.length - 1"
               [ngClass]="{ 'active': isStageActive(stages[i + 1]) }">
          </div>
        </div>

        <div class="stage-icon my-1">
          <i [ngClass]="stageIcons[i]" class="stage-symbol fs-4"></i>
        </div>

        <div class="stage-label mt-1 fw-semibold"
             [ngClass]="{ 'active': isStageActive(stage) }">
          {{ stage }}
        </div>
      </div>
    </div>
  </div>

  <div class="order-info mt-4" *ngIf="progress">
    <p><strong>Schedule ID:</strong> {{ progress.productionScheduleId }}</p>
    <p><strong>Current Stage:</strong> {{ progress.stage }}</p>
    <p><strong>Product Name:</strong> {{ progress.productName }}</p>
  </div>
</div>
